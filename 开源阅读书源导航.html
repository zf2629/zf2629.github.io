
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="å¼€æºé˜…è¯»ä¹¦æºå¯¼èˆª - ä¸€é”®å¯¼å…¥æœ€æ–°ä¹¦æºåˆé›†">
    <title>å¼€æºé˜…è¯»ä¹¦æºå¯¼èˆª</title>
    <style>
        :root {
            --primary-color: #4285f4;
            --hover-color: #e3f2fd;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        .subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        .search-box {
            margin: 30px auto;
            width: 90%;
            max-width: 600px;
            position: relative;
        }
        #search-input {
            width: 100%;
            padding: 12px 20px;
            border-radius: 30px;
            border: 1px solid #ddd;
            font-size: 16px;
            outline: none;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }
        #search-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 8px rgba(66, 133, 244, 0.3);
        }
        .category {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }
        .category-title {
            font-size: 1.4rem;
            font-weight: bold;
            border-bottom: 2px solid #eee;
            padding-bottom: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .category-title i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        .source-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 18px;
        }
        .source-item {
            background: #fff;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .source-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: var(--primary-color);
        }
        .source-name {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.1rem;
            color: #222;
        }
        .source-desc {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }
        .source-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #999;
        }
        .source-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .action-btn {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }
        .copy-btn {
            background: #f1f1f1;
            color: #333;
        }
        .import-btn {
            background: var(--primary-color);
            color: white;
        }
        .favorite-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: #ccc;
            transition: all 0.2s;
        }
        .favorite-btn.active {
            color: #ff5252;
        }
        .footer {
            text-align: center;
            margin-top: 50px;
            color: #999;
            font-size: 0.9rem;
            padding: 20px 0;
            border-top: 1px solid #eee;
        }
        .import-guide {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 30px 0;
            border-left: 4px solid var(--primary-color);
        }
        .no-results {
            text-align: center;
            padding: 30px;
            color: #666;
            display: none;
        }
        .live-time {
            font-weight: bold;
            color: var(--primary-color);
        }
        @media (max-width: 768px) {
            .source-list {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“š å¼€æºé˜…è¯»ä¹¦æºå¯¼èˆª</h1>
            <p class="subtitle">ä¸€é”®å¯¼å…¥æœ€æ–°ä¹¦æºåˆé›† Â· æ¯æ—¥è‡ªåŠ¨æ›´æ–°</p>
        </header>

        <div class="import-guide">
            <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong> 
            <ul>
                <li>ç‚¹å‡»"ä¸€é”®å¯¼å…¥"ç›´æ¥å¯¼å…¥ä¹¦æºåˆ°é˜…è¯»APP</li>
                <li>æˆ–ç‚¹å‡»"å¤åˆ¶é“¾æ¥"æ‰‹åŠ¨åˆ°APPä¸­ç½‘ç»œå¯¼å…¥</li>
            </ul>
        </div>

        <div class="search-box">
            <input type="text" id="search-input" placeholder="æœç´¢ä¹¦æºåç§°æˆ–æè¿°...">
        </div>

        <div id="no-results" class="no-results">
            <p>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ä¹¦æºï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯</p>
        </div>

        <div class="category">
            <div class="category-title"><i>ğŸ”¥</i> çƒ­é—¨ä¹¦æºåˆé›†</div>
            <div class="source-list" id="hot-sources"></div>
        </div>

        <div class="category">
            <div class="category-title"><i>ğŸ“–</i> å°è¯´ä¹¦æº</div>
            <div class="source-list" id="novel-sources"></div>
        </div>

        <div class="category">
            <div class="category-title"><i>ğŸ¬</i> å½±è§†/çŸ­å‰§ä¹¦æº</div>
            <div class="source-list" id="drama-sources"></div>
        </div>
        
        <div class="category">
            <div class="category-title"><i>ğŸ“±</i> è½¯ä»¶/APPä¸‹è½½</div>
            <div class="source-list" id="app-sources"></div>
        </div>
        
        <div class="category">
            <div class="category-title"><i>â­</i> æˆ‘çš„æ”¶è—</div>
            <div class="source-list" id="favorite-sources"></div>
        </div>

        <div class="footer">
            <p>æ•°æ®æ¯æ—¥è‡ªåŠ¨æ›´æ–° | å½“å‰æ—¶é—´ï¼š<span id="update-time" class="live-time"></span></p>
            <p>Â©2025 å¼€æºé˜…è¯»ä¹¦æºå¯¼èˆª | ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨</p>
        </div>
    </div>

    <script>
        // ç¯å¢ƒæ£€æµ‹ - åˆ¤æ–­æ˜¯å¦åœ¨é˜…è¯»APPå†…æ‰“å¼€
        const isInLegadoApp = () => {
            return navigator.userAgent.includes('Legado') || 
                   document.referrer.includes('legado://') ||
                   window.location.href.startsWith('http://localhost');
        };

        // ä¹¦æºæ•°æ®åº“
        const sourceDatabase = {
            hot: [
                 {
                    name: "å¤§ç°ç‹¼ä¹¦æº", 
                    url: "https://legado.aoaostar.com/sources/e29e19ee.json",
                    desc: "ç²¾é€‰ä¼˜è´¨ä¹¦æºï¼Œè¦†ç›–å…¨ç½‘ä¸»æµå¹³å°",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "ä¸‰èˆä¹¦æº", 
                    url: "https://legado.aoaostar.com/sources/2a1f129b.json",
                    desc: "ç²¾é€‰ä¼˜è´¨ä¹¦æºï¼Œè¦†ç›–å…¨ç½‘ä¸»æµå¹³å°",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "ç ´å†°ä¹¦æº", 
                    url: "https://legado.aoaostar.com/sources/4dc410d1.json",
                    desc: "ç²¾é€‰ä¼˜è´¨ä¹¦æºï¼Œè¦†ç›–å…¨ç½‘ä¸»æµå¹³å°",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "XIUä¹¦æº", 
                    url: "https://legado.aoaostar.com/sources/71e56d4f.json",
                    desc: "ç²¾é€‰ä¼˜è´¨ä¹¦æºï¼Œè¦†ç›–å…¨ç½‘ä¸»æµå¹³å°",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "é…·å®‰ä¹¦æº", 
                    url: "https://legado.aoaostar.com/sources/3bb7b751.json",
                    desc: "ç²¾é€‰ä¼˜è´¨ä¹¦æºï¼Œè¦†ç›–å…¨ç½‘ä¸»æµå¹³å°",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "æºä»“åº“ä¹¦æºå¤§å…¨", 
                    url: "http://www.yckceo.com/yuedu/shuyuan/index.html",
                    desc: "ä¸“ä¸šä¹¦æºæ”¶å½•å¹³å°ï¼Œåˆ†ç±»æ¸…æ™°",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "é˜…è¯»3.0å®˜æ–¹ä¹¦æº", 
                    url: "https://gitee.com/ThomasYou/yd/raw/master/sy/3.0.json",
                    desc: "å®˜æ–¹ç»´æŠ¤çš„ç¨³å®šä¹¦æº",
                    date: "å®æ—¶æ›´æ–°"
                }
            ],
            novel: [
                {
                    name: "èŒ„ç•ªå°è¯´å…¨ç«™ä¹¦æº", 
                    url: "https://cdn.jsdelivr.net/gh/yuedu520/yuedu@main/2503061.json",
                    desc: "åŒ…å«ç•ªèŒ„å°è¯´æ‰€æœ‰ä¹¦æº",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "æŸç‚¹/æŸå¢ä¹¦æºåˆé›†", 
                    url: "https://cdn.jsdelivr.net/gh/yuedu520/yuedu@main/250315.json",
                    desc: "ä¸»æµä»˜è´¹å°è¯´å¹³å°ä¹¦æº",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "ç¬”è¶£é˜é•œåƒæºåˆé›†", 
                    url: "https://cdn.jsdelivr.net/gh/yuedu520/yuedu@main/250401.json",
                    desc: "å¤šä¸ªç¬”è¶£é˜é•œåƒç«™ç‚¹ä¹¦æº",
                    date: "å®æ—¶æ›´æ–°"
                }
            ],
            drama: [
                {
                    name: "çƒ­é—¨çŸ­å‰§ä¹¦æºåˆé›†", 
                    url: "https://cdn.jsdelivr.net/gh/yuedu520/yuedu@main/2503153.json",
                    desc: "åŒ…å«æœ€æ–°çŸ­å‰§èµ„æº",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "å–µå…¬å­å½±è§†ä¹¦æº", 
                    url: "https://namofree.coding.net/p/yuedu/d/legado/git/raw/master/legadoNamo.json",
                    desc: "å½±è§†ç±»èµ„æºä¸°å¯Œ",
                    date: "å®æ—¶æ›´æ–°"
                }
            ],
            app: [
                {
                    name: "å¤¸å…‹ç½‘ç›˜ä¸‹è½½", 
                    url: "https://pan.quark.cn/s/7a39190ec0a2",
                    desc: "åŒ…å«å¾ˆå¤šç±»å‹å°è¯´APP",
                    date: "å®æ—¶æ›´æ–°"
                },
                {
                    name: "æœ¬åœ°ä¹¦æº+ä¸»é¢˜+å­—ä½“", 
                    url: "https://pan.quark.cn/s/170c3744af6a",
                    desc: "ä¸»é¢˜åŒ…å¤§å…¨",
                    date: "å®æ—¶æ›´æ–°"
                }
            ]
        };

        // æ›´æ–°å®æ—¶æ—¶é—´å‡½æ•°
        function updateLiveTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('update-time').textContent = timeString;
        }

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®åˆå§‹æ—¶é—´å¹¶å¯åŠ¨å®šæ—¶å™¨
            updateLiveTime();
            setInterval(updateLiveTime, 1000);
            
            // å¦‚æœæ˜¯APPå†…æ‰“å¼€ï¼Œä¿®æ”¹UIæç¤º
            if (isInLegadoApp()) {
                document.querySelector('.subtitle').textContent += ' (APPå†…æ‰“å¼€)';
                document.querySelector('.import-guide li:first-child').textContent = 
                    'ç‚¹å‡»"ä¸€é”®å¯¼å…¥"ç›´æ¥å¯¼å…¥ä¹¦æºåˆ°å½“å‰APP';
            }
            
            // æ¸²æŸ“æ‰€æœ‰ä¹¦æº
            renderAllSources();
            
            // åˆå§‹åŒ–æœç´¢åŠŸèƒ½
            initSearch();
            
            // åŠ è½½æ”¶è—
            renderFavorites();
        });

        // æ¸²æŸ“æ‰€æœ‰ä¹¦æºåˆ†ç±»
        function renderAllSources() {
            renderSourceCategory('hot', 'hot-sources');
            renderSourceCategory('novel', 'novel-sources');
            renderSourceCategory('drama', 'drama-sources');
            renderSourceCategory('app', 'app-sources');
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶
            addSourceClickEvents();
        }

        // æ¸²æŸ“å•ä¸ªåˆ†ç±»ä¹¦æº
        function renderSourceCategory(category, elementId) {
            const container = document.getElementById(elementId);
            const sources = sourceDatabase[category];
            
            container.innerHTML = sources.map((source, index) => {
                const isFavorite = checkIsFavorite(source.url);
                const importUrl = `legado://import/bookSource?src=${encodeURIComponent(source.url)}`;
                return `
                    <div class="source-item" data-url="${source.url}" data-name="${source.name}">
                        <button class="favorite-btn ${isFavorite ? 'active' : ''}" data-url="${source.url}">â¤</button>
                        <div class="source-name">${source.name}</div>
                        <div class="source-desc">${source.desc}</div>
                        <div class="source-meta">
                            <span>${source.date}</span>
                            <span>${category === 'hot' ? 'æ¨è' : ''}</span>
                        </div>
                        <div class="source-actions">
                            <button class="action-btn import-btn" data-import="${importUrl}" data-url="${source.url}">ä¸€é”®å¯¼å…¥</button>
                            <button class="action-btn copy-btn" data-url="${source.url}">å¤åˆ¶é“¾æ¥</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // æ·»åŠ ä¹¦æºç‚¹å‡»äº‹ä»¶
        function addSourceClickEvents() {
            // ä¸€é”®å¯¼å…¥æŒ‰é’®
            document.querySelectorAll('.import-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const importUrl = this.getAttribute('data-import');
                    const sourceUrl = this.getAttribute('data-url');
                    
                    if (isInLegadoApp()) {
                        // åœ¨APPå†…ç›´æ¥ä½¿ç”¨JS APIå¯¼å…¥
                        try {
                            if (typeof app !== 'undefined' && app.importBookSource) {
                                app.importBookSource(sourceUrl);
                                showToast('ä¹¦æºå¯¼å…¥ä¸­...');
                            } else {
                                window.location.href = importUrl;
                            }
                        } catch (error) {
                            window.location.href = importUrl;
                        }
                    } else {
                        // å¤–éƒ¨æµè§ˆå™¨æ‰“å¼€
                        window.location.href = importUrl;
                        
                        // æ·»åŠ å¤‡ç”¨æ–¹æ¡ˆ
                        setTimeout(() => {
                            if (!document.hidden) {
                                copyToClipboard(sourceUrl);
                                showToast('æœªæ£€æµ‹åˆ°é˜…è¯»APPï¼Œå·²å¤åˆ¶é“¾æ¥ï¼Œè¯·æ‰‹åŠ¨å¯¼å…¥');
                            }
                        }, 500);
                    }
                });
            });
            
            // å¤åˆ¶é“¾æ¥æŒ‰é’®
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const url = this.getAttribute('data-url');
                    copyToClipboard(url);
                    showToast('å·²å¤åˆ¶ä¹¦æºé“¾æ¥åˆ°å‰ªè´´æ¿');
                });
            });
            
            // æ”¶è—æŒ‰é’®ç‚¹å‡»
            document.querySelectorAll('.favorite-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const url = this.getAttribute('data-url');
                    toggleFavorite(url);
                    this.classList.toggle('active');
                    renderFavorites();
                });
            });
        }

        // åˆå§‹åŒ–æœç´¢åŠŸèƒ½
        function initSearch() {
            const searchInput = document.getElementById('search-input');
            const noResults = document.getElementById('no-results');
            
            searchInput.addEventListener('input', function() {
                const keyword = this.value.trim().toLowerCase();
                let hasResults = false;
                
                if (keyword === '') {
                    document.querySelectorAll('.source-item').forEach(item => {
                        item.style.display = 'block';
                    });
                    noResults.style.display = 'none';
                    return;
                }
                
                document.querySelectorAll('.source-item').forEach(item => {
                    const name = item.getAttribute('data-name').toLowerCase();
                    const desc = item.querySelector('.source-desc').textContent.toLowerCase();
                    
                    if (name.includes(keyword) || desc.includes(keyword)) {
                        item.style.display = 'block';
                        hasResults = true;
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                noResults.style.display = hasResults ? 'none' : 'block';
            });
        }

        // æ¸²æŸ“æ”¶è—ä¹¦æº
        function renderFavorites() {
            const favorites = getFavorites();
            const container = document.getElementById('favorite-sources');
            
            if (favorites.length === 0) {
                container.innerHTML = '<p style="text-align:center;color:#666;">æš‚æ— æ”¶è—çš„ä¹¦æº</p>';
                return;
            }
            
            container.innerHTML = favorites.map(url => {
                const source = findSourceByUrl(url);
                if (!source) return '';
                
                const importUrl = `legado://import/bookSource?src=${encodeURIComponent(source.url)}`;
                return `
                    <div class="source-item" data-url="${source.url}" data-name="${source.name}">
                        <button class="favorite-btn active" data-url="${source.url}">â¤</button>
                        <div class="source-name">${source.name}</div>
                        <div class="source-desc">${source.desc}</div>
                        <div class="source-meta">
                            <span>${source.date}</span>
                        </div>
                        <div class="source-actions">
                            <button class="action-btn import-btn" data-import="${importUrl}" data-url="${source.url}">ä¸€é”®å¯¼å…¥</button>
                            <button class="action-btn copy-btn" data-url="${source.url}">å¤åˆ¶é“¾æ¥</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            // é‡æ–°ç»‘å®šäº‹ä»¶
            addSourceClickEvents();
        }

        // æ”¶è—ç›¸å…³å‡½æ•°
        function toggleFavorite(url) {
            const favorites = getFavorites();
            const index = favorites.indexOf(url);
            
            if (index === -1) {
                favorites.push(url);
            } else {
                favorites.splice(index, 1);
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        function getFavorites() {
            return JSON.parse(localStorage.getItem('favorites') || '[]');
        }

        function checkIsFavorite(url) {
            const favorites = getFavorites();
            return favorites.includes(url);
        }

        function findSourceByUrl(url) {
            for (const category in sourceDatabase) {
                const found = sourceDatabase[category].find(s => s.url === url);
                if (found) return found;
            }
            return null;
        }

        // å·¥å…·å‡½æ•°
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = decodeURIComponent(text);
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.position = 'fixed';
            toast.style.bottom = '20px';
            toast.style.left = '50%';
            toast.style.transform = 'translateX(-50%)';
            toast.style.backgroundColor = 'rgba(0,0,0,0.7)';
            toast.style.color = 'white';
            toast.style.padding = '10px 20px';
            toast.style.borderRadius = '5px';
            toast.style.zIndex = '1000';
            toast.style.transition = 'opacity 0.3s';
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 2000);
        }
    </script>
</body>
</html>